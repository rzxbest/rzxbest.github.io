---
title: 学MQ所得
date: 2022-02-28 14:59:29
tags: [Mysql]
categories: [Mysql]
---

### 梳理出来自己负责的系统的核心业务流程，核心功能模块，跟其他系统是如何交互的，数据是如何存储，当前已经使用了哪些中间件技术。



### 系统与系统之间的耦合性体现
来思考一个问题，假设促销系统现在有一个接口，专门是让你调用了以后派发优惠券的，现在这个接口接收的参数有 5个，你要是调用这个接口，就必须给他传递5个参数过去，这个是没的说的。
现在问题来了，负责促销系统的工程师某一天突然有一个新的想法，他希望改一改这个接口，在接口调用的时候需要传递7个参数！
一旦他的这个新接口上线了，你还是给他传5个参数，那么他那里就会报错，这个派发优惠券的行为就会失败！
那在这样的一个情况下应该怎么办？
    很简单，你作为订单系统的负责人，必须要配合促销系统去修改代码，既然他要7个参数，那么你就必须得在代码里调用他的接口的时候传递7个参数。
并且你还得配合他的新接口去进行测试以及部署上线，你必须得围绕着他转，配合他。
在这种情况下，就说明你的订单系统跟促销系统是强耦合的

### 订单系统存在的问题

![img.png](aimg.png)

### 消息中间件
异步化提升性能，降低系统耦合，流量削峰

- 解耦异步
    引入MQ之前,a系统调用b系统
    ![img_2.png](aimg_2.png)
    引入MQ之后
    ![img_3.png](aimg_3.png)
- 削峰
    MQ这个技术抗高并发的能力远远高于数据库，同样的机器配置下，如果数据库可以抗每秒6000请求，MQ至少可以抗每秒几万请求。
    ![img_1.png](aimg_1.png)
    MQ进行流量削峰的效果，系统A发送过来的每秒1万请求是一个流量洪峰，然后MQ直接给扛下来了，都存储自己本地磁盘，这个过程就是流量削峰的过程，瞬间把一个洪峰给削下来了，让系统B后续慢慢获取消息来处理。
