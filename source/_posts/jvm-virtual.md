---
title: JAVA虚拟机
date: 2021-11-25 19:20:47
tags: [JAVA,JAVA虚拟机]
categories: [JAVA]

---

![image-20211126094454822](image-20211126094454822.png)

## 栈

- 每开启一个线程，就开辟一块栈内存区域
- 栈帧：遇到一方法就新建一块栈帧放入栈中
- 方法执行完，对应栈帧出栈销毁

#### 栈帧

- 局部变量表 ：存局部变量
- 操作数栈 ： 做运算
- 动态链接 ：方法入口地址 符号引用转为入口地址
- 方法出口

![image-20211126094254239](image-20211126094254239.png)

#### 反汇编查看字节码文件

javap -c ***.class

#### 单个栈空间大小设置参数

-Xss128k （默认1m）

栈空间满了会出现StackOverFlowError，调用链过长可能导致此位置，或者递归调用

## 堆

![image-20211126094600649](image-20211126094600649.png)

堆参数设置：

- -Xms  初始堆大小 例：-Xms256m
- -Xmx  最大堆大小 例：-Xms256m
- -Xmn  新生代大小     例：-Xmn1m

## 方法区(元空间)

主要存常量，静态变量，类元信息

jdk1.8类元数据放到了**本地内存**中，将**常量池**和**静态变量**放到了Java**堆**， jdk1.7 及以前存储堆中在持久代

方法区设置参数1.8

- -XX:MetaspaceSize:
- -XX:MetaspaceSize:

## 程序计数器

存储正在执行的语句的行号（地址），线程私有，当语句执行完成，字节码执行引擎对程序计数器进行修改
